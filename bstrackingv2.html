<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ñ–∏—Å –¢—Ä–∞–∫–µ—Ä 3x2 | –•–∏–±—Ä–∏–¥–µ–Ω –º–æ–¥–µ–ª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .quick-add {
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .quick-add h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .date-input {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .date-input input {
            flex: 1;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            min-width: 200px;
        }

        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            flex: 1;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 150px;
        }

        .btn-office {
            background: #4CAF50;
            color: white;
        }

        .btn-office:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }

        .btn-home {
            background: #2196F3;
            color: white;
        }

        .btn-home:hover {
            background: #0b7dda;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.3);
        }

        .btn-vacation {
            background: #FF9800;
            color: white;
        }

        .btn-vacation:hover {
            background: #e68900;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 152, 0, 0.3);
        }

        .btn-holiday {
            background: #9C27B0;
            color: white;
        }

        .btn-holiday:hover {
            background: #7B1FA2;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(156, 39, 176, 0.3);
        }

        .btn-info {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: 2px solid white;
            font-size: 1.1em;
            padding: 12px 25px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-info:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 0;
            border-radius: 20px;
            max-width: 600px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px 30px;
            border-radius: 20px 20px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 1.8em;
        }

        .close-btn {
            color: white;
            font-size: 35px;
            font-weight: bold;
            cursor: pointer;
            background: none;
            border: none;
            line-height: 1;
            transition: transform 0.2s;
        }

        .close-btn:hover {
            transform: scale(1.2);
        }

        .modal-body {
            padding: 30px;
            line-height: 1.8;
        }

        .info-section {
            margin-bottom: 25px;
        }

        .info-section h3 {
            color: #667eea;
            margin-bottom: 12px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-section p {
            margin: 8px 0;
            color: #555;
        }

        .info-highlight {
            background: #f0f4ff;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            margin: 15px 0;
        }

        @media (max-width: 768px) {
            .modal-content {
                margin: 10% 20px;
                max-width: none;
            }

            .modal-body {
                padding: 20px;
            }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        .stat-card h3 {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            margin-bottom: 15px;
            letter-spacing: 1px;
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #999;
            font-size: 0.9em;
        }

        .progress-bar {
            background: #e0e0e0;
            border-radius: 10px;
            height: 20px;
            margin: 15px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease, background 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.8em;
        }

        .status-indicator {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
            margin-top: 10px;
        }

        .status-good {
            background: #d4edda;
            color: #155724;
        }

        .status-warning {
            background: #fff3cd;
            color: #856404;
        }

        .status-danger {
            background: #f8d7da;
            color: #721c24;
        }

        .calendar {
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .calendar h2 {
            color: #333;
            margin-bottom: 20px;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .calendar-day {
            aspect-ratio: 1;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid #e0e0e0;
        }

        .calendar-day:hover {
            transform: scale(1.05);
        }

        .day-number {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .day-office {
            background: #c8e6c9;
            border-color: #4CAF50;
        }

        .day-home {
            background: #bbdefb;
            border-color: #2196F3;
        }

        .day-home-auto {
            background: #e3f2fd;
            border-color: #90caf9;
            border-style: dashed;
        }

        .day-vacation {
            background: #ffe0b2;
            border-color: #FF9800;
        }

        .day-holiday {
            background: #e1bee7;
            border-color: #9C27B0;
        }

        .day-weekend {
            background: #f5f5f5;
            color: #999;
        }

        .day-header {
            font-weight: bold;
            color: #667eea;
            padding: 10px;
            text-align: center;
        }

        .legend {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .legend-color {
            width: 30px;
            height: 30px;
            border-radius: 5px;
        }

        .period-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .period-btn {
            padding: 10px 20px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .period-btn.active {
            background: #667eea;
            color: white;
        }

        .period-btn:hover {
            transform: translateY(-2px);
        }

        .alert {
            padding: 15px 20px;
            border-radius: 10px;
            margin-top: 15px;
            font-weight: bold;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }

            .calendar-grid {
                gap: 5px;
            }

            .calendar-day {
                font-size: 0.7em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè¢ –û—Ñ–∏—Å –¢—Ä–∞–∫–µ—Ä 3x2</h1>
            <p>–ü—Ä–æ—Å–ª–µ–¥—è–≤–∞–Ω–µ –Ω–∞ —Ö–∏–±—Ä–∏–¥–Ω–∏—è —Ä–∞–±–æ—Ç–µ–Ω –º–æ–¥–µ–ª</p>
            <p style="margin-top: 10px; color: #667eea; font-weight: 600; font-size: 0.95em;">Created by Bozhidar Stoykov</p>
            <div style="margin-top: 20px;">
                <button class="btn-info" onclick="openInfoModal()">
                    ‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è - –ö–∞–∫ —Ä–∞–±–æ—Ç–∏?
                </button>
            </div>
        </div>

        <div class="quick-add">
            <h2>üìÖ –î–æ–±–∞–≤–∏ –¥–µ–Ω</h2>
            <div class="date-input">
                <input type="date" id="dateInput">
            </div>
            <div class="button-group">
                <button class="btn btn-office" onclick="addDay('office')">üè¢ –û—Ñ–∏—Å</button>
                <button class="btn btn-home" onclick="addDay('home')">üè† Home Office</button>
                <button class="btn btn-vacation" onclick="addDay('vacation')">üå¥ –ü–æ—á–∏–≤–∫–∞/–ë–æ–ª–Ω–∏—á–µ–Ω</button>
                <button class="btn btn-holiday" onclick="addDay('holiday')">üéâ –ü—Ä–∞–∑–Ω–∏–∫</button>
            </div>
        </div>

        <div class="period-selector">
            <button class="period-btn active" onclick="changePeriod('week')">–°–µ–¥–º–∏—Ü–∞</button>
            <button class="period-btn" onclick="changePeriod('month')">–ú–µ—Å–µ—Ü</button>
            <button class="period-btn" onclick="changePeriod('quarter')">–¢—Ä–∏–º–µ—Å–µ—á–∏–µ (Q1/Q2/Q3/Q4)</button>
        </div>

        <div class="stats-grid" id="statsGrid">
            <!-- Stats will be inserted here -->
        </div>

        <div class="calendar">
            <h2 id="calendarTitle">–ö–∞–ª–µ–Ω–¥–∞—Ä</h2>
            <div class="calendar-grid" id="calendarGrid">
                <!-- Calendar will be inserted here -->
            </div>
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color day-office"></div>
                    <span>–û—Ñ–∏—Å</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color day-home"></div>
                    <span>Home Office (–º–∞—Ä–∫–∏—Ä–∞–Ω)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color day-home-auto"></div>
                    <span>Home Office (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color day-vacation"></div>
                    <span>–ü–æ—á–∏–≤–∫–∞/–ë–æ–ª–Ω–∏—á–µ–Ω</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color day-holiday"></div>
                    <span>–ü—Ä–∞–∑–Ω–∏–∫</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color day-weekend"></div>
                    <span>–ü–æ—á–∏–≤–µ–Ω –¥–µ–Ω (—É–∏–∫–µ–Ω–¥)</span>
                </div>
            </div>
        </div>

        <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); padding: 20px; border-radius: 15px; text-align: center; margin-top: 30px; color: white;">
            <p style="margin: 0; font-size: 0.9em;">
                <strong>–û—Ñ–∏—Å –¢—Ä–∞–∫–µ—Ä 3x2</strong> | –°—ä–∑–¥–∞–¥–µ–Ω–æ –æ—Ç <strong>Bozhidar Stoykov</strong>
            </p>
            <p style="margin: 5px 0 0 0; font-size: 0.8em; opacity: 0.8;">
                v1.0 | –§–µ–≤—Ä—É–∞—Ä–∏ 2026 | –î–∞–Ω–Ω–∏—Ç–µ —Å–µ —Å—ä—Ö—Ä–∞–Ω—è–≤–∞—Ç –ª–æ–∫–∞–ª–Ω–æ –≤—ä–≤ –≤–∞—à–∏—è –±—Ä–∞—É–∑—ä—Ä
            </p>
        </div>
    </div>

    <!-- Info Modal -->
    <div id="infoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ÑπÔ∏è –ö–∞–∫ —Ä–∞–±–æ—Ç–∏ –û—Ñ–∏—Å –¢—Ä–∞–∫–µ—Ä—ä—Ç?</h2>
                <button class="close-btn" onclick="closeInfoModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="info-section">
                    <h3>üè¢ –û—Ñ–∏—Å –±—É—Ç–æ–Ω</h3>
                    <p>–ú–∞—Ä–∫–∏—Ä–∞–π –¥–Ω–∏—Ç–µ –∫–æ–≥–∞—Ç–æ —Å–∏ –±–∏–ª —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –≤ –æ—Ñ–∏—Å–∞. –¢–µ–∑–∏ –¥–Ω–∏ —Å–µ –±—Ä–æ—è—Ç –∫—ä–º –∫–æ–º–ø–ª–∞–π—ä–Ω—Å —Ü–µ–ª—Ç–∞ –æ—Ç 60%.</p>
                </div>

                <div class="info-section">
                    <h3>üè† Home Office –±—É—Ç–æ–Ω</h3>
                    <p><strong>–ú–æ–∂–µ—à –¥–∞ –º–∞—Ä–∫–∏—Ä–∞—à –∏–∑—Ä–∏—á–Ω–æ</strong> –∏–ª–∏ –¥–∞ –æ—Å—Ç–∞–≤–∏—à –ø—Ä–∞–∑–Ω–æ - –º–∏–Ω–∞–ª–∏ —Ä–∞–±–æ—Ç–Ω–∏ –¥–Ω–∏ –±–µ–∑ –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–µ –±—Ä–æ—è—Ç –∫–∞—Ç–æ Home Office.</p>
                    <p style="font-size: 0.9em; color: #666;">‚Ä¢ –ú–∞—Ä–∫–∏—Ä–∞–Ω–∏ home office –¥–Ω–∏ ‚Üí —Ç—ä–º–Ω–æ —Å–∏–Ω—å–æ —Å üè†</p>
                    <p style="font-size: 0.9em; color: #666;">‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏ home office ‚Üí —Å–≤–µ—Ç–ª–æ —Å–∏–Ω—å–æ —Å üì±</p>
                </div>

                <div class="info-section">
                    <h3>üå¥ –ü–æ—á–∏–≤–∫–∞/–ë–æ–ª–Ω–∏—á–µ–Ω –±—É—Ç–æ–Ω</h3>
                    <p>–ú–∞—Ä–∫–∏—Ä–∞–π –æ—Ç–ø—É—Å–∫–∏, –±–æ–ª–Ω–∏—á–Ω–∏ –∏ –ø—Ä–∞–∑–Ω–∏—Ü–∏. –¢–µ–∑–∏ –¥–Ω–∏ —Å–µ <strong>–ø—Ä–∏—Å–ø–∞–¥–∞—Ç</strong> –æ—Ç –æ–±—â–∏—Ç–µ —Ä–∞–±–æ—Ç–Ω–∏ –¥–Ω–∏ –∏ –ù–ï –≤–ª–∏—è—è—Ç –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ –Ω–∞ –∫–æ–º–ø–ª–∞–π—ä–Ω—Å–∞.</p>
                </div>

                <div class="info-section">
                    <h3>üéâ –ü—Ä–∞–∑–Ω–∏–∫ –±—É—Ç–æ–Ω</h3>
                    <p>–ó–∞ –æ—Ñ–∏—Ü–∏–∞–ª–Ω–∏ –ø—Ä–∞–∑–Ω–∏—Ü–∏ (1 —è–Ω—É–∞—Ä–∏, 3 –º–∞—Ä—Ç –∏ —Ç.–Ω.). –ü—Ä–∏—Å–ø–∞–¥–∞—Ç —Å–µ –æ—Ç –∫–æ–º–ø–ª–∞–π—ä–Ω—Å –∏–∑—á–∏—Å–ª–µ–Ω–∏–µ—Ç–æ.</p>
                </div>

                <div class="info-highlight">
                    <h3>üéØ –ö–æ–º–ø–ª–∞–π—ä–Ω—Å —Ü–µ–ª: 60%</h3>
                    <p><strong>–ö–∞–∫ —Å–µ –∏–∑—á–∏—Å–ª—è–≤–∞:</strong></p>
                    <p>–û–±—â–æ —Ä–∞–±–æ—Ç–Ω–∏ –¥–Ω–∏ - –ü–æ—á–∏–≤–∫–∏ - –ü—Ä–∞–∑–Ω–∏—Ü–∏ = –ù–∞–ª–∏—á–Ω–∏ –¥–Ω–∏</p>
                    <p>–ù–∞–ª–∏—á–Ω–∏ –¥–Ω–∏ √ó 60% = –ù–µ–æ–±—Ö–æ–¥–∏–º–∏ –æ—Ñ–∏—Å –¥–Ω–∏</p>
                    <p><em>–ü—Ä–∏–º–µ—Ä: 60 —Ä–∞–±–æ—Ç–Ω–∏ –¥–Ω–∏ - 5 –ø–æ—á–∏–≤–∫–∏ = 55 –¥–Ω–∏ ‚Üí –ù—É–∂–Ω–∏ 33 –æ—Ñ–∏—Å –¥–Ω–∏ (60%)</em></p>
                </div>

                <div class="info-section">
                    <h3>üìä –ü–µ—Ä–∏–æ–¥–∏ –∑–∞ –ø—Ä–æ—Å–ª–µ–¥—è–≤–∞–Ω–µ</h3>
                    <p><strong>–°–µ–¥–º–∏—Ü–∞</strong> - —Ç–µ–∫—É—â–∞—Ç–∞ —Å–µ–¥–º–∏—Ü–∞ (–ü–Ω-–ù–¥)</p>
                    <p><strong>–ú–µ—Å–µ—Ü</strong> - —Ç–µ–∫—É—â–∏—è—Ç –º–µ—Å–µ—Ü (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–µ —Å–º–µ–Ω—è)</p>
                    <p><strong>–¢—Ä–∏–º–µ—Å–µ—á–∏–µ</strong> - Q1 (–Ø–Ω-–ú–∞—Ä), Q2 (–ê–ø—Ä-–Æ–Ω–∏), Q3 (–Æ–ª–∏-–°–µ–ø), Q4 (–û–∫—Ç-–î–µ–∫)</p>
                </div>

                <div class="info-section">
                    <h3>üíæ –ó–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏</h3>
                    <p>–î–∞–Ω–Ω–∏—Ç–µ —Å–µ —Å—ä—Ö—Ä–∞–Ω—è–≤–∞—Ç <strong>–ª–æ–∫–∞–ª–Ω–æ –≤ –±—Ä–∞—É–∑—ä—Ä–∞</strong> –Ω–∞ —Ç–æ–≤–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ.</p>
                    <p style="color: #e67e22; font-weight: bold;">‚ö†Ô∏è –í–∞–∂–Ω–æ: –í—Å—è–∫–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏–º–∞ –æ—Ç–¥–µ–ª–Ω–∏ –¥–∞–Ω–Ω–∏! –¢–µ–ª–µ—Ñ–æ–Ω, –∫–æ–º–ø—é—Ç—ä—Ä - —Ä–∞–∑–ª–∏—á–Ω–∏ –∑–∞–ø–∏—Å–∏.</p>
                </div>

                <div class="info-section">
                    <h3>üé® –¶–≤–µ—Ç–æ–≤–∞ –ª–µ–≥–µ–Ω–¥–∞</h3>
                    <p>üü¢ –ó–µ–ª–µ–Ω–æ - –û—Ñ–∏—Å | üîµ –°–∏–Ω—å–æ - Home Office (–º–∞—Ä–∫–∏—Ä–∞–Ω)</p>
                    <p>üî∑ –°–≤–µ—Ç–ª–æ —Å–∏–Ω—å–æ - Home Office (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ) | üü† –û—Ä–∞–Ω–∂–µ–≤–æ - –ü–æ—á–∏–≤–∫–∞</p>
                    <p>üü£ –õ–∏–ª–∞–≤–æ - –ü—Ä–∞–∑–Ω–∏–∫ | ‚ö™ –°–∏–≤–æ - –£–∏–∫–µ–Ω–¥</p>
                </div>

                <div class="info-highlight" style="background: #d4edda; border-color: #4CAF50;">
                    <p style="margin: 0; font-weight: bold; color: #155724;">üí° –°—ä–≤–µ—Ç: –ú–∞—Ä–∫–∏—Ä–∞–π —Å–∞–º–æ –æ—Ñ–∏—Å –¥–Ω–∏—Ç–µ –∏ –ø–æ—á–∏–≤–∫–∏—Ç–µ - –æ—Å—Ç–∞–Ω–∞–ª–æ—Ç–æ —Å–µ –±—Ä–æ–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∫–∞—Ç–æ home office!</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize data
        let attendanceData = JSON.parse(localStorage.getItem('attendanceData')) || {};
        let currentPeriod = 'quarter';

        // Set today's date in input
        document.getElementById('dateInput').valueAsDate = new Date();

        function addDay(type) {
            const dateInput = document.getElementById('dateInput').value;
            if (!dateInput) {
                alert('–ú–æ–ª—è –∏–∑–±–µ—Ä–∏ –¥–∞—Ç–∞!');
                return;
            }

            const date = new Date(dateInput + 'T00:00:00');
            const dayOfWeek = date.getDay();
            
            // Check if weekend
            if (dayOfWeek === 0 || dayOfWeek === 6) {
                if (!confirm('–ò–∑–±—Ä–∞–Ω–∞ –µ –ø–æ—á–∏–≤–µ–Ω –¥–µ–Ω. –°–∏–≥—É—Ä–µ–Ω –ª–∏ —Å–∏?')) {
                    return;
                }
            }

            attendanceData[dateInput] = type;
            localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
            
            updateDisplay();
            
            // Move to next working day
            const nextDate = new Date(date);
            nextDate.setDate(nextDate.getDate() + 1);
            
            // Skip weekends
            while (nextDate.getDay() === 0 || nextDate.getDay() === 6) {
                nextDate.setDate(nextDate.getDate() + 1);
            }
            
            document.getElementById('dateInput').valueAsDate = nextDate;
        }

        function changePeriod(period) {
            currentPeriod = period;
            
            // Update button states
            document.querySelectorAll('.period-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            updateDisplay();
        }

        function updateDisplay() {
            updateStats();
            updateCalendar();
        }

        function getDateRange(period) {
            const today = new Date();
            let startDate, endDate;

            if (period === 'week') {
                // Current week (Monday to Sunday)
                const dayOfWeek = today.getDay();
                const diff = dayOfWeek === 0 ? -6 : 1 - dayOfWeek;
                startDate = new Date(today);
                startDate.setDate(today.getDate() + diff);
                endDate = new Date(startDate);
                endDate.setDate(startDate.getDate() + 6);
            } else if (period === 'month') {
                // Current month - full month
                startDate = new Date(today.getFullYear(), today.getMonth(), 1);
                endDate = new Date(today.getFullYear(), today.getMonth() + 1, 0);
            } else if (period === 'quarter') {
                // Current quarter (Q1: Jan-Mar, Q2: Apr-Jun, Q3: Jul-Sep, Q4: Oct-Dec)
                const currentMonth = today.getMonth();
                const quarterStartMonth = Math.floor(currentMonth / 3) * 3;
                startDate = new Date(today.getFullYear(), quarterStartMonth, 1);
                endDate = new Date(today.getFullYear(), quarterStartMonth + 3, 0);
            }

            return { startDate, endDate };
        }

        function getWorkingDaysInRange(startDate, endDate) {
            let count = 0;
            const current = new Date(startDate);
            
            while (current <= endDate) {
                const dayOfWeek = current.getDay();
                if (dayOfWeek !== 0 && dayOfWeek !== 6) {
                    count++;
                }
                current.setDate(current.getDate() + 1);
            }
            
            return count;
        }

        function updateStats() {
            const { startDate, endDate } = getDateRange(currentPeriod);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            let officeDays = 0;
            let homeDays = 0;
            let vacationDays = 0;
            let holidayDays = 0;
            let autoHomeDays = 0;
            
            const current = new Date(startDate);
            while (current <= endDate) {
                const dateStr = current.toISOString().split('T')[0];
                const dayOfWeek = current.getDay();
                
                if (dayOfWeek !== 0 && dayOfWeek !== 6) {
                    const recordedType = attendanceData[dateStr];
                    
                    if (recordedType === 'office') {
                        officeDays++;
                    } else if (recordedType === 'home') {
                        homeDays++;
                    } else if (recordedType === 'vacation') {
                        vacationDays++;
                    } else if (recordedType === 'holiday') {
                        holidayDays++;
                    } else if (current < today) {
                        // Past working day with no record = auto home office
                        autoHomeDays++;
                    }
                }
                
                current.setDate(current.getDate() + 1);
            }

            const totalHomeDays = homeDays + autoHomeDays;
            const totalWorkingDays = getWorkingDaysInRange(startDate, endDate);
            const totalRecordedDays = officeDays + totalHomeDays + vacationDays + holidayDays;
            const availableWorkingDays = totalWorkingDays - vacationDays - holidayDays;
            const targetOfficeDays = Math.round(availableWorkingDays * 0.6);
            const compliancePercent = availableWorkingDays > 0 ? (officeDays / availableWorkingDays * 100) : 0;
            const remainingOfficeDays = Math.max(0, targetOfficeDays - officeDays);

            let statusClass, statusText, alertHTML = '';
            
            if (compliancePercent >= 60) {
                statusClass = 'status-good';
                statusText = '‚úÖ –ö–æ–º–ø–ª–∞–π—ä–Ω—Ç';
            } else if (compliancePercent >= 50) {
                statusClass = 'status-warning';
                statusText = '‚ö†Ô∏è –ë–ª–∏–∑–æ –¥–æ —Ü–µ–ª—Ç–∞';
                alertHTML = `<div class="alert alert-warning">–í–Ω–∏–º–∞–Ω–∏–µ! –¢—Ä—è–±–≤–∞—Ç –æ—â–µ ${remainingOfficeDays} –¥–Ω–∏ –≤ –æ—Ñ–∏—Å–∞ –¥–æ –∫—Ä–∞—è –Ω–∞ –ø–µ—Ä–∏–æ–¥–∞.</div>`;
            } else {
                statusClass = 'status-danger';
                statusText = '‚ùå –ü–æ–¥ —Ü–µ–ª—Ç–∞';
                alertHTML = `<div class="alert alert-warning">–í–Ω–∏–º–∞–Ω–∏–µ! –ó–Ω–∞—á–∏—Ç–µ–ª–Ω–æ –∏–∑–æ—Å—Ç–∞–≤–∞–Ω–µ - –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏ ${remainingOfficeDays} –æ—Ñ–∏—Å –¥–Ω–∏!</div>`;
            }

            let periodName = currentPeriod === 'week' ? '–°–µ–¥–º–∏—Ü–∞' : 
                           currentPeriod === 'month' ? '–ú–µ—Å–µ—Ü' : 
                           '–¢—Ä–∏–º–µ—Å–µ—á–∏–µ';

            const statsHTML = `
                <div class="stat-card">
                    <h3>üè¢ –î–Ω–∏ –≤ –û—Ñ–∏—Å–∞</h3>
                    <div class="stat-value" style="color: #4CAF50;">${officeDays}</div>
                    <div class="stat-label">–æ—Ç ${availableWorkingDays} —Ä–∞–±–æ—Ç–Ω–∏ –¥–Ω–∏</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${(officeDays/availableWorkingDays*100) || 0}%; background: #4CAF50;">
                            ${Math.round((officeDays/availableWorkingDays*100) || 0)}%
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <h3>üéØ –ö–æ–º–ø–ª–∞–π—ä–Ω—Å (60% –¶–µ–ª)</h3>
                    <div class="stat-value" style="color: ${compliancePercent >= 60 ? '#4CAF50' : compliancePercent >= 50 ? '#FF9800' : '#f44336'};">
                        ${Math.round(compliancePercent)}%
                    </div>
                    <div class="stat-label">–¶–µ–ª: ${targetOfficeDays} –æ—Ñ–∏—Å –¥–Ω–∏</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${Math.min(compliancePercent, 100)}%; 
                             background: ${compliancePercent >= 60 ? '#4CAF50' : compliancePercent >= 50 ? '#FF9800' : '#f44336'};">
                            ${Math.round(compliancePercent)}%
                        </div>
                    </div>
                    <div class="status-indicator ${statusClass}">${statusText}</div>
                </div>

                <div class="stat-card">
                    <h3>üìä –û–±–æ–±—â–µ–Ω–∏–µ –∑–∞ ${periodName}</h3>
                    <div style="margin: 15px 0;">
                        <div style="display: flex; justify-content: space-between; margin: 10px 0;">
                            <span>üè¢ –û—Ñ–∏—Å:</span>
                            <strong style="color: #4CAF50;">${officeDays} –¥–Ω–∏</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 10px 0;">
                            <span>üè† Home Office:</span>
                            <strong style="color: #2196F3;">${totalHomeDays} –¥–Ω–∏</strong>
                        </div>
                        ${autoHomeDays > 0 ? `
                        <div style="display: flex; justify-content: space-between; margin: 5px 0 10px 20px; font-size: 0.9em; color: #666;">
                            <span>‚Ü≥ –º–∞—Ä–∫–∏—Ä–∞–Ω–∏:</span>
                            <span>${homeDays}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 5px 0 10px 20px; font-size: 0.9em; color: #666;">
                            <span>‚Ü≥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏:</span>
                            <span>${autoHomeDays}</span>
                        </div>
                        ` : ''}
                        <div style="display: flex; justify-content: space-between; margin: 10px 0;">
                            <span>üå¥ –ü–æ—á–∏–≤–∫–∞/–ë–æ–ª–Ω–∏—á–µ–Ω:</span>
                            <strong style="color: #FF9800;">${vacationDays} –¥–Ω–∏</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 10px 0;">
                            <span>üéâ –ü—Ä–∞–∑–Ω–∏—Ü–∏:</span>
                            <strong style="color: #9C27B0;">${holidayDays} –¥–Ω–∏</strong>
                        </div>
                        <hr style="margin: 15px 0; border: none; border-top: 2px solid #e0e0e0;">
                        <div style="display: flex; justify-content: space-between; margin: 10px 0;">
                            <span><strong>–û—Å—Ç–∞–≤–∞—Ç –æ—Ñ–∏—Å –¥–Ω–∏:</strong></span>
                            <strong style="color: #667eea; font-size: 1.3em;">${remainingOfficeDays}</strong>
                        </div>
                    </div>
                    ${alertHTML}
                </div>
            `;

            document.getElementById('statsGrid').innerHTML = statsHTML;
        }

        function updateCalendar() {
            const { startDate, endDate } = getDateRange(currentPeriod);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const monthNames = ['–Ø–Ω—É–∞—Ä–∏', '–§–µ–≤—Ä—É–∞—Ä–∏', '–ú–∞—Ä—Ç', '–ê–ø—Ä–∏–ª', '–ú–∞–π', '–Æ–Ω–∏', 
                              '–Æ–ª–∏', '–ê–≤–≥—É—Å—Ç', '–°–µ–ø—Ç–µ–º–≤—Ä–∏', '–û–∫—Ç–æ–º–≤—Ä–∏', '–ù–æ–µ–º–≤—Ä–∏', '–î–µ–∫–µ–º–≤—Ä–∏'];
            
            let title = '';
            if (currentPeriod === 'week') {
                title = `–°–µ–¥–º–∏—Ü–∞: ${startDate.getDate()} ${monthNames[startDate.getMonth()]} - ${endDate.getDate()} ${monthNames[endDate.getMonth()]} ${endDate.getFullYear()}`;
            } else if (currentPeriod === 'month') {
                title = `${monthNames[startDate.getMonth()]} ${startDate.getFullYear()}`;
            } else {
                const quarterNum = Math.floor(startDate.getMonth() / 3) + 1;
                const quarterMonths = [
                    '–Ø–Ω—É–∞—Ä–∏ - –ú–∞—Ä—Ç',
                    '–ê–ø—Ä–∏–ª - –Æ–Ω–∏',
                    '–Æ–ª–∏ - –°–µ–ø—Ç–µ–º–≤—Ä–∏',
                    '–û–∫—Ç–æ–º–≤—Ä–∏ - –î–µ–∫–µ–º–≤—Ä–∏'
                ];
                title = `Q${quarterNum} ${startDate.getFullYear()} (${quarterMonths[quarterNum - 1]})`;
            }
            
            document.getElementById('calendarTitle').textContent = title;

            let calendarHTML = '';
            const dayNames = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–ù–¥'];
            
            // Add day headers
            dayNames.forEach(day => {
                calendarHTML += `<div class="day-header">${day}</div>`;
            });

            // Find the first Monday
            const firstDay = new Date(startDate);
            const dayOfWeek = firstDay.getDay();
            const diff = dayOfWeek === 0 ? -6 : 1 - dayOfWeek;
            firstDay.setDate(firstDay.getDate() + diff);

            // Generate calendar days
            const current = new Date(firstDay);
            const lastDay = new Date(endDate);
            
            // Extend to end of week
            while (lastDay.getDay() !== 0) {
                lastDay.setDate(lastDay.getDate() + 1);
            }

            while (current <= lastDay) {
                const dateStr = current.toISOString().split('T')[0];
                const dayOfWeek = current.getDay();
                const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
                const dayType = attendanceData[dateStr] || '';
                const isPast = current < today;
                
                let className = 'calendar-day';
                let emoji = '';
                
                if (isWeekend) {
                    className += ' day-weekend';
                } else if (dayType === 'office') {
                    className += ' day-office';
                    emoji = 'üè¢';
                } else if (dayType === 'home') {
                    className += ' day-home';
                    emoji = 'üè†';
                } else if (dayType === 'vacation') {
                    className += ' day-vacation';
                    emoji = 'üå¥';
                } else if (dayType === 'holiday') {
                    className += ' day-holiday';
                    emoji = 'üéâ';
                } else if (isPast) {
                    // Past working day with no record = auto home office
                    className += ' day-home-auto';
                    emoji = 'üì±';
                }

                const isInRange = current >= startDate && current <= endDate;
                const opacity = isInRange ? '1' : '0.3';

                calendarHTML += `
                    <div class="${className}" style="opacity: ${opacity}" 
                         onclick="selectDate('${dateStr}')" 
                         title="${dateStr}">
                        <div class="day-number">${current.getDate()}</div>
                        <div>${emoji}</div>
                    </div>
                `;

                current.setDate(current.getDate() + 1);
            }

            document.getElementById('calendarGrid').innerHTML = calendarHTML;
        }

        function selectDate(dateStr) {
            document.getElementById('dateInput').value = dateStr;
        }

        // Initial display
        updateDisplay();

        function openInfoModal() {
            document.getElementById('infoModal').style.display = 'block';
        }

        function closeInfoModal() {
            document.getElementById('infoModal').style.display = 'none';
        }

        // Close modal when clicking outside of it
        window.onclick = function(event) {
            const modal = document.getElementById('infoModal');
            if (event.target == modal) {
                closeInfoModal();
            }
        }
    </script>
</body>
</html>